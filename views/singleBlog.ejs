<%- include("header") %>

<% const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'June', 'July', 'Aug', 'Sept', 'Oct', 'Nov', 'Dec']

function calculateReadingTime(text){
    const wordsPerMinute = 200; // Average case.
    let result;

    let textLength = text.split(" ").length; // Split by words
    if(textLength > 0){
        let value = Math.ceil(textLength / wordsPerMinute);
        result = `${value} min read`;
    }
    return result
}


%>

<div class="flex flex-col justify-center px-2 gap-10 w-[680px] mx-auto py-14">
    <h1 class="text-4xl font-bold"><%= blog.title %></h1>
    <div class="float-left flex gap-4 items-center">
        <img class="object-cover w-16 rounded-full" src="data:image/<%= blog.author.profile_picture.contentType%>;base64,<%= blog.author.profile_picture.data.toString('base64') %>" alt="">
        <div>
            <p class="capitalize font-semibold"><%= blog.author.name %><a href="" class="text-blue-400 ml-5">Follow</a></p>
            <div class="flex gap-2 text-sm text-gray-500">
                <p><%= calculateReadingTime(blog.body) %></p>
                .
                <p><%= new Date(blog.createdAt).getFullYear() %>  <%= months[new Date(blog.createdAt).getMonth()] %>  <%= new Date(blog.createdAt).getDate() %></p>
            </div>
        </div>
    </div>
    <p><%- blog.body %></p>
    <div class="flex gap-3 font-semibold">
        <% for (let i = 0; i < blog.tags.length; i++){ %>
            <p class="w-fit px-4 py-2 bg-gray-300 rounded-3xl"><%= blog.tags[i] %></p>
        <% } %>
    </div>
</div>
